doctype html
html(lang='en', dir='ltr')
  head
    meta(charset='utf-8')
    link(href='https://fonts.googleapis.com/css?family=EB+Garamond&display=swap', rel='stylesheet')
    title Text Donation
    style(media='screen').
      .pulsate {
      -webkit-animation: pulsate 3s ease-out;
      -webkit-animation-iteration-count: infinite;
      opacity: 0.5;
      color: orange;
      text-align: center;
      font-size: 300%;
      }
      @-webkit-keyframes pulsate {
      0% {
      opacity: 0.5;
      }
      50% {
      opacity: 1.0;
      }
      100% {
      opacity: 0.5;
      }
      }
      .center {
      display: block;
      margin-left: auto;
      margin-right: auto;
      font-family: 'EB Garamond', serif;
      }
      .ml9 {
      padding: 0 20%;
      text-align: center;
      font-size: 150%;
      color: white;
      font-family: 'EB Garamond', serif;
      }
  script(src='/socket.io/socket.io.js')
  body
    #donation.container
      img.center(src='giphy.gif', alt='this slowpoke moves', width='150/')
      h1.pulsate Вася - 100₽
      h1.ml9
        span.text-wrapper
          span.letters
            | Привет Паша. Как твои дела? когда катнешь на ИС7? Я давно хотел задонатить и вот появилась возможность
    script(src='https://cdnjs.cloudflare.com/ajax/libs/animejs/2.0.2/anime.min.js')
    script(type='text/javascript').
      var socket = io();
      if (socket !== null) {
      // название рума будет нашим user_id
      var room = "abc123";
      // connection
      socket.on('connect', function() {
      // сюда заходит
      socket.emit('room', room);
      console.log('connected to ' + room);
      });
      // message
      socket.on('message', function(data) {
      console.log(data)
      showDonation(data);
      setTimeout(function() {
      hideDiv()
      }, 5000);
      });
      }
      function showDonation(data) {
      //- var textWrapper = document.querySelector('.ml9 .letters');
      //- textWrapper.innerHTML = data;
      document.getElementById("donation").innerHTML = data;
      anime.timeline({
      loop: false
      })
      .add({
      targets: '.ml9 .letter',
      scale: [0, 1],
      duration: 1500,
      elasticity: 600,
      delay: (el, i) => 30 * (i + 30),
      });
      }
      function hideDiv() {
      var x = document.getElementById("donation");
      x.style.display = "none";
      }
